<!DOCTYPE html><html lang="zh-Hans"><head><!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]--><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="呼哧"><meta name="description" content="Acdreamer博客数论学习Day One等比数列求和．求解$S_n = (a+a^2+…+a^n)modM$采用二分．n%2==0时 $ S_n = (1+a^{(\frac{n}{2})} )S_{\frac{n}{2}} $ ,n%2==1时，$S_n = (1+a^{\frac{n+1}{2}})S_{\frac{n-1}{2}} + a^{\frac{n+1}{2}}$12345678"><meta name="keywords" content="acm"><meta property="og:type" content="article"><meta property="og:title" content="Acdreamer博客数论学习(1)"><meta property="og:url" content="http://hu-chi.github.io/2017/07/19/acm/Acdreamer博客数论学习(1)/index.html"><meta property="og:site_name" content="Play with huchi"><meta property="og:description" content="Acdreamer博客数论学习Day One等比数列求和．求解$S_n = (a+a^2+…+a^n)modM$采用二分．n%2==0时 $ S_n = (1+a^{(\frac{n}{2})} )S_{\frac{n}{2}} $ ,n%2==1时，$S_n = (1+a^{\frac{n+1}{2}})S_{\frac{n-1}{2}} + a^{\frac{n+1}{2}}$12345678"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2018-08-03T18:45:59.134Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Acdreamer博客数论学习(1)"><meta name="twitter:description" content="Acdreamer博客数论学习Day One等比数列求和．求解$S_n = (a+a^2+…+a^n)modM$采用二分．n%2==0时 $ S_n = (1+a^{(\frac{n}{2})} )S_{\frac{n}{2}} $ ,n%2==1时，$S_n = (1+a^{\frac{n+1}{2}})S_{\frac{n-1}{2}} + a^{\frac{n+1}{2}}$12345678"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="alternate" href="/atom.xml" title="Play with huchi" type="application/atom+xml"><link rel="shortcut icon" href="/img/huchi.jpg"><link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet"><link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet"><title>Acdreamer博客数论学习(1) | Play with huchi</title><script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script>var yiliaConfig={fancybox:!0,animate:!0,isHome:!1,isPost:!0,isArchive:!1,isTag:!1,isCategory:!1,fancybox_js:"//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",scrollreveal:"//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",search:!0}</script><script>yiliaConfig.jquery_ui=[!0,"//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js","//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"]</script><script>yiliaConfig.rootUrl="/"</script></head></html><body><div id="container"><div class="left-col"><div class="overlay"></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="/img/huchi.jpg" class="animated zoomIn"></a><hgroup><h1 class="header-author"><a href="/">呼哧</a></h1></hgroup><p class="header-subtitle">看遍南海风云卷，最恨难赴故人约。</p><form id="search-form"><input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false"> <i class="fa fa-times" onclick="resetSearch()"></i></form><div id="local-search-result"></div><p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p><div id="switch-btn" class="switch-btn"><div class="icon"><div class="icon-ctn"><div class="icon-wrap icon-house" data-idx="0"><div class="birdhouse"></div><div class="birdhouse_holes"></div></div><div class="icon-wrap icon-ribbon hide" data-idx="1"><div class="ribbon"></div></div><div class="icon-wrap icon-link hide" data-idx="2"><div class="loopback_l"></div><div class="loopback_r"></div></div><div class="icon-wrap icon-me hide" data-idx="3"><div class="user"></div><div class="shoulder"></div></div></div></div><div class="tips-box hide"><div class="tips-arrow"></div><ul class="tips-inner"><li>菜单</li><li>标签</li><li>友情链接</li><li>关于我</li></ul></div></div><div id="switch-area" class="switch-area"><div class="switch-wrap"><section class="switch-part switch-part1"><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/随笔">随笔</a></li><li><a href="/tags/">标签云</a></li><li><a href="/about/">关于我</a></li></ul></nav><nav class="header-nav"><ul class="social"><a class="fa Email" href="/779197837@qq.com" title="Email"></a> <a class="fa GitHub" href="#" title="GitHub"></a> <a class="fa RSS" href="/atom.xml" title="RSS"></a></ul></nav></section><section class="switch-part switch-part2"><div class="widget tagcloud" id="js-tagcloud"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/">Hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/">Machine Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/acm/">acm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/script/">script</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/starts/">starts</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端设计/">前端设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/杂书/">杂书</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络编程/">网络编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔/">随笔</a></li></ul></div></section><section class="switch-part switch-part3"><div id="js-friends"><a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a> <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a> <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a></div></section><section class="switch-part switch-part4"><div id="js-aboutme">专注于前端</div></section></div></div></header></div></div><div class="mid-col"><nav id="mobile-nav"><div class="overlay"><div class="slider-trigger"></div><h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">呼哧</a></h1></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="/img/huchi.jpg" class="animated zoomIn"></a><hgroup><h1 class="header-author"><a href="/" title="回到主页">呼哧</a></h1></hgroup><p class="header-subtitle">看遍南海风云卷，最恨难赴故人约。</p><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/随笔">随笔</a></li><li><a href="/tags/">标签云</a></li><li><a href="/about/">关于我</a></li><div class="clearfix"></div></ul></nav><nav class="header-nav"><ul class="social"><a class="fa Email" target="_blank" href="/779197837@qq.com" title="Email"></a> <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a> <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a></ul></nav></header></div><link class="menu-list" tags="标签" friends="友情链接" about="关于我"></nav><div class="body-wrap"><article id="article-acm/Acdreamer博客数论学习(1)" class="article article-type-article" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2017/07/19/acm/Acdreamer博客数论学习(1)/" class="article-date"><time datetime="2017-07-19T10:40:42.000Z" itemprop="datePublished">2017-07-19</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 class="article-title" itemprop="name">Acdreamer博客数论学习(1)</h1></header><div class="article-info article-info-post"><div class="article-category tagcloud"><a class="article-category-link" href="/categories/acm/">acm</a></div><div class="article-tag tagcloud"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/acm/">acm</a></li></ul></div><div class="clearfix"></div></div><div class="article-entry" itemprop="articleBody"><h1 id="Acdreamer博客数论学习"><a href="#Acdreamer博客数论学习" class="headerlink" title="Acdreamer博客数论学习"></a>Acdreamer博客数论学习</h1><h1 id="Day-One"><a href="#Day-One" class="headerlink" title="Day One"></a>Day One</h1><h2 id="等比数列求和．"><a href="#等比数列求和．" class="headerlink" title="等比数列求和．"></a><strong>等比数列求和．</strong></h2><p>求解$S_n = (a+a^2+…+a^n)modM$</p><p>采用二分．n%2==0时 $ S_n = (1+a^{(\frac{n}{2})} )S_{\frac{n}{2}} $ ,n%2==1时，$S_n = (1+a^{\frac{n+1}{2}})S_{\frac{n-1}{2}} + a^{\frac{n+1}{2}}$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">pow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>)ans=ans*a%mod;</span><br><span class="line">        a=a*a%mod;</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">1</span>)<span class="keyword">return</span> a%mod;</span><br><span class="line">    <span class="keyword">if</span>(n&amp;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> ((<span class="number">1</span>+<span class="built_in">pow</span>(a,(n+<span class="number">1</span>)/<span class="number">2</span>))%mod*S(a,(n<span class="number">-1</span>)/<span class="number">2</span>)%mod + <span class="built_in">pow</span>(a,(n+<span class="number">1</span>)/<span class="number">2</span>)%mod)%mod;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1</span>+<span class="built_in">pow</span>(a,n/<span class="number">2</span>))%mod*S(a,n/<span class="number">2</span>)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a,n;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;n))&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,S(a,n));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>题目：<a href="https://vjudge.net/problem/POJ-3233．" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-3233．</a></p><p>计算矩阵１－n次方和</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,k,m;</span><br><span class="line"><span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> mp[<span class="number">35</span>][<span class="number">35</span>];</span><br><span class="line">    Matrix()&#123;</span><br><span class="line">        <span class="built_in">memset</span>(mp,<span class="number">0</span>,<span class="keyword">sizeof</span> mp);</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix(<span class="keyword">int</span> v)&#123;</span><br><span class="line">        <span class="built_in">memset</span>(mp,<span class="number">0</span>,<span class="keyword">sizeof</span> mp);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            mp[i][i] = v;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">Matrix <span class="title">multi</span><span class="params">(Matrix a, Matrix b)</span></span>&#123;</span><br><span class="line">    Matrix c;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)&#123;<span class="keyword">if</span>(a.mp[i][k])</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;<span class="keyword">if</span>(b.mp[k][j])</span><br><span class="line">                c.mp[i][j] = c.mp[i][j] + a.mp[i][k]*b.mp[k][j];</span><br><span class="line">                c.mp[i][j] %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">Matrix <span class="title">pls</span><span class="params">(Matrix a, Matrix b)</span></span>&#123;</span><br><span class="line">    Matrix c;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">            c.mp[i][j] = a.mp[i][j]+b.mp[i][j];</span><br><span class="line">            c.mp[i][j] %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Matrix <span class="title">powmul</span><span class="params">(Matrix a, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    Matrix c = Matrix(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        c.mp[i][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>)c = multi(c,a);</span><br><span class="line">        a = multi(a,a);</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">Matrix <span class="title">S</span><span class="params">(Matrix a, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">    Matrix temp = Matrix(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(k==<span class="number">1</span>)<span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">if</span>(k&amp;<span class="number">1</span>)&#123;</span><br><span class="line">        Matrix temp2 = powmul(a,(k+<span class="number">1</span>)/<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> pls(multi(pls(temp, temp2), S(a,(k<span class="number">-1</span>)/<span class="number">2</span>)), temp2);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        Matrix temp2 = powmul(a,k/<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">return</span> multi(pls(temp, temp2), S(a,k/<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;k,&amp;m))&#123;</span><br><span class="line">        Matrix a;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a.mp[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mod = m;</span><br><span class="line">        a = S(a,k);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span> ; i &lt;= n; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d"</span>,a.mp[i][j]);</span><br><span class="line">                <span class="keyword">if</span>(j!=n)<span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="素数定理"><a href="#素数定理" class="headerlink" title="素数定理"></a>素数定理</h2><p>$$<br>\pi(n)为小于等于n的素数的个数，有lim_{n→∞}\frac{\pi(n)}{n/lnn}=1<br>$$</p><h2 id="定理-gcd-a-n-1-a-m-1-a-gcd-n-m-1"><a href="#定理-gcd-a-n-1-a-m-1-a-gcd-n-m-1" class="headerlink" title="定理$gcd(a^n-1,a^m-1)=a^{gcd(n,m)}-1$"></a>定理$gcd(a^n-1,a^m-1)=a^{gcd(n,m)}-1$</h2><p>在a&gt;1,m,n&gt;0时成立．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> mod = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b?gcd(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">pow</span><span class="params">(ll a, ll k)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>)ans=ans*a%mod;</span><br><span class="line">        a = a*a%mod;</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a,m,n,k1,t;<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>,&amp;a,&amp;m,&amp;n,&amp;k1);</span><br><span class="line">        mod = k1;</span><br><span class="line">        ll ans = <span class="built_in">pow</span>(a,gcd(n,m))<span class="number">-1</span>+mod;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans%mod);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="定理扩展-a-gt-b-gcd-a-b-1-gcd-a-m-b-m-a-n-b-n-a-gcd-m-n-b-gcd-m-n"><a href="#定理扩展-a-gt-b-gcd-a-b-1-gcd-a-m-b-m-a-n-b-n-a-gcd-m-n-b-gcd-m-n" class="headerlink" title="定理扩展$a&gt;b,gcd(a,b)=1, gcd(a^m-b^m,a^n-b^n)=a^{gcd(m,n)}-b^{gcd(m,n)}$"></a>定理扩展$a&gt;b,gcd(a,b)=1, gcd(a^m-b^m,a^n-b^n)=a^{gcd(m,n)}-b^{gcd(m,n)}$</h2><h2 id="定理-G-gcd-C-n-1-C-n-2-C-n-3-…-Cn-n-1"><a href="#定理-G-gcd-C-n-1-C-n-2-C-n-3-…-Cn-n-1" class="headerlink" title="定理$G=gcd(C_n^1,C_n^2,C_n^3,…,Cn^{n-1})$"></a>定理$G=gcd(C_n^1,C_n^2,C_n^3,…,Cn^{n-1})$</h2><ol><li>n为素数，答案为n；</li><li>n有多个素因子，答案为１；</li><li>n只有一个素因子,答案就是该素因子(其实包括了第一种情况</li></ol><p>题目：<a href="https://vjudge.net/problem/HDU-2582" target="_blank" rel="noopener">https://vjudge.net/problem/HDU-2582</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000100</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> judge[maxn];</span><br><span class="line"><span class="keyword">int</span> prime[maxn/<span class="number">10</span>];</span><br><span class="line">ll biao[maxn];</span><br><span class="line"><span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(prime,<span class="number">0</span>,<span class="keyword">sizeof</span> prime);</span><br><span class="line">    <span class="built_in">memset</span>(judge,<span class="number">0</span>,<span class="keyword">sizeof</span> judge);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!judge[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i+i; j &lt; maxn; j+=i)&#123;</span><br><span class="line">                judge[j]=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            prime[tot++]=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fill(biao,biao+maxn,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll j = prime[i]; j &lt; maxn; j*=prime[i])&#123;</span><br><span class="line">            biao[j]=prime[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">4</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">        biao[i]+=biao[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n))&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,biao[n]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="定理-F-n-为斐波那契额数列-，gcd-F-m-F-n-F-gcd-m-n"><a href="#定理-F-n-为斐波那契额数列-，gcd-F-m-F-n-F-gcd-m-n" class="headerlink" title="定理$F_n 为斐波那契额数列 ，gcd(F_m,F_n)=F_{gcd(m,n)}$"></a>定理$F_n 为斐波那契额数列 ，gcd(F_m,F_n)=F_{gcd(m,n)}$</h2><p><a href="http://acm.nyist.net/JudgeOnline/problem.php?pid=468" target="_blank" rel="noopener">http://acm.nyist.net/JudgeOnline/problem.php?pid=468</a></p><p>此处需要学会一种新的判断素数的方式叫做Miller_Rabin素数测试．在DayTwo中有．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">multi</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> b, <span class="keyword">long</span> <span class="keyword">long</span> mod)</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> temp = a, sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(b)&#123;</span><br><span class="line">		<span class="keyword">if</span>(b &amp; <span class="number">1</span>) sum = (sum + temp) % mod;</span><br><span class="line">		temp = (temp + temp) % mod;</span><br><span class="line">		b = b &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">Modular_exponent</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> mod)</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> t = a % mod, r = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(x)&#123;</span><br><span class="line">		<span class="keyword">if</span>(x &amp; <span class="number">1</span>) r = multi(r, t, mod);</span><br><span class="line">		t = multi(t, t, mod); x = x &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Miller_Rabin</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> time = <span class="number">20</span>;</span><br><span class="line">	<span class="keyword">if</span>(n &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">if</span>(n == <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> k = <span class="number">0</span>; k &lt;= time; ++k)&#123;</span><br><span class="line">		flag = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">long</span> <span class="keyword">long</span> d = n - <span class="number">1</span>, r = <span class="number">0</span>, t, a = rand() % (n - <span class="number">2</span>) + <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">while</span>((d &amp; <span class="number">1</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">			d = d&gt;&gt;<span class="number">1</span>;</span><br><span class="line">			r++;</span><br><span class="line">		&#125;</span><br><span class="line">		t = Modular_exponent(a, d, n);</span><br><span class="line">		<span class="keyword">if</span>(t == <span class="number">1</span> || t == n<span class="number">-1</span>) &#123;flag = <span class="literal">true</span>; <span class="keyword">continue</span>;&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> i = <span class="number">1</span>; i &lt; r; i++)&#123;</span><br><span class="line">			t = multi(t, t, n);</span><br><span class="line">			<span class="keyword">if</span>(t == <span class="number">1</span>) &#123;flag = <span class="literal">false</span>; <span class="keyword">return</span> flag;&#125;</span><br><span class="line">			<span class="keyword">if</span>(t == n<span class="number">-1</span>) &#123;flag = <span class="literal">true</span>; <span class="keyword">break</span>;&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(!flag) <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">long</span> <span class="keyword">long</span> n;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n)!=EOF)</span><br><span class="line">	<span class="built_in">puts</span>((n == <span class="number">4</span> || (n != <span class="number">2</span> &amp;&amp; Miller_Rabin(n))) ? <span class="string">"Yes"</span> : <span class="string">"No"</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="定理：给定两个互素的正整数A和B，那么他们最大不能组合的数为AB-A-B-不能组合的个数为num-frac-A-1-B-1-2"><a href="#定理：给定两个互素的正整数A和B，那么他们最大不能组合的数为AB-A-B-不能组合的个数为num-frac-A-1-B-1-2" class="headerlink" title="定理：给定两个互素的正整数Ａ和Ｂ，那么他们最大不能组合的数为AB-A-B,不能组合的个数为num=$\frac{(A-1)(B-1)}{2}$"></a>定理：给定两个互素的正整数Ａ和Ｂ，那么他们最大不能组合的数为AB-A-B,不能组合的个数为num=$\frac{(A-1)(B-1)}{2}$</h2><p>ax+by=c的存在非负解的条件就是c&gt;AB-A-B.</p><p><a href="https://vjudge.net/problem/37337/origin" target="_blank" rel="noopener">HDU - 1792</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a,b;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;b))&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,a*b-a-b,(a<span class="number">-1</span>)*(b<span class="number">-1</span>)/<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="定理-sum-gcd-i-N-sum-d-phi-frac-N-d"><a href="#定理-sum-gcd-i-N-sum-d-phi-frac-N-d" class="headerlink" title="定理$\sum{gcd(i,N)=\sum{d\phi(\frac{N}{d})}}$"></a>定理$\sum{gcd(i,N)=\sum{d\phi(\frac{N}{d})}}$</h2><p>数论专题里也有一题如是说．</p><p><a href="https://vjudge.net/problem/POJ-2480" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-2480</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 50000</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">bool</span> judge[maxn];</span><br><span class="line"><span class="keyword">int</span> prime[maxn];</span><br><span class="line"><span class="keyword">int</span> tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    tot = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(judge,<span class="number">0</span>,<span class="keyword">sizeof</span> judge);</span><br><span class="line">    <span class="built_in">memset</span>(prime, <span class="number">0</span>, <span class="keyword">sizeof</span> prime);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!judge[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i+i;  j &lt; maxn; j+=i)&#123;</span><br><span class="line">                judge[j] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            prime[tot++]=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    ll n;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n))&#123;</span><br><span class="line">        ll ans = n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot &amp;&amp; prime[i]*prime[i] &lt;= n; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(n%prime[i]==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> cot = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span>(n%prime[i]==<span class="number">0</span>)&#123;cot++;n/=prime[i];&#125;</span><br><span class="line">                ans += ans * cot * (prime[i]<span class="number">-1</span>)/prime[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(n!=<span class="number">1</span>)ans += ans*(n<span class="number">-1</span>)/n;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="剩下没有题目的定理"><a href="#剩下没有题目的定理" class="headerlink" title="剩下没有题目的定理"></a>剩下没有题目的定理</h2><p>$$<br>(n+1)lcm(C_n^0,C_n^1,C_n^2,…,C_N^{n-1},C_n^N)=lcm(1,2,…,n+1)<br>$$</p><p>$$<br>定理：任何n个连续的正整数的乘积均可被n!整除<br>$$</p><p>结论：<br>$$<br>如果p是素数，那么C_p^1,C_p^2,C_p^3,…C_p^{p-1},均能被p整除\<br>如果p是素数，那么有(x+y+..+w)^p≡x^p+y^p+…+w^p(mod p)\<br>$$</p><h1 id="Day-Two"><a href="#Day-Two" class="headerlink" title="Day Two"></a>Day Two</h1><h2 id="卢卡斯－莱默检验法-检验梅森素数"><a href="#卢卡斯－莱默检验法-检验梅森素数" class="headerlink" title="卢卡斯－莱默检验法 检验梅森素数"></a>卢卡斯－莱默检验法 检验梅森素数</h2><p>$$<br>梅森素数M_p =2^p-1，p为素数．，定义序列{s_i}，所有的i ≥ 0, \<br>si= \begin{cases} 4, i=0 \ s_{i-1}^{2}-2,i&gt;0 \end{cases}<br>M_p是素数当且仅当s_{p-2} \equiv 0(modM_p)<br>$$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">ll T,p;</span><br><span class="line"><span class="function">ll <span class="title">multi</span><span class="params">(ll a, ll b, ll m)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>)ans = (ans+a)%m;</span><br><span class="line">        a = (a+a)%m;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;p);</span><br><span class="line">        ll n = ((ll) <span class="number">1</span>&lt;&lt;p)<span class="number">-1</span>;</span><br><span class="line">        ll r = <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span>(p==<span class="number">2</span>)<span class="built_in">puts</span>(<span class="string">"yes"</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">while</span>((--p)!=<span class="number">1</span>)r=(multi(r,r,n)<span class="number">-2</span>+n)%n;</span><br><span class="line">            <span class="keyword">if</span>(r%n==<span class="number">0</span>)<span class="built_in">puts</span>(<span class="string">"yes"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"no"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Miller-Rabin素数测试"><a href="#Miller-Rabin素数测试" class="headerlink" title="Miller-Rabin素数测试"></a>Miller-Rabin素数测试</h2><p>​ <strong>费马小定理</strong>：对于素数p和任意整数a，有$$a^p ≡ a(mod p)$$（同余）。反过来，满足$$a^p ≡ a(mod p)$$，p也<strong>几乎</strong>一定是素数。</p><p>　　<strong>伪素数</strong>：如果n是一个正整数，如果存在和n互素的正整数a满足 $a^{n-1} ≡ 1(mod n)$，我们说n是基于a的伪素数。如果一个数是伪素数，那么它几乎肯定是素数。</p><p>​ 序列:<br>​ a^m%n; a^(2m)%n; a^(4m)%n; …… ;a^(m*2^q)%n把上述测试序列叫做Miller测试,关于Miller测试,有下面的定理:</p><p>定理:若n是素数,a是小于n的正整数,则n对以a为基的Miller测试,结果为真.Miller测试进行k次,将合数当成素数处理的错误概率最多不会超过4^(-k).</p><p>　　<strong>Miller-Rabin测试</strong>：不断选取不超过n-1的基b(s次)，计算是否每次都有$$b^{n-1} ≡ 1(mod n)$$，若每次都成立则n是素数，否则为合数。　</p><p>​ <strong>二次探测定理 </strong>：p为素数，０&lt;x&lt;p,则方程$x^2 ≡ 1(mod p)的解为１或者p-1$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Times = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">multi</span><span class="params">(ll a, ll b ,ll m)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    a%=m;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>)ans = (ans+a)%m;</span><br><span class="line">        a = (a+a)%m;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_mod</span><span class="params">(ll a, ll b, ll m)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    a %= m;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>)ans = multi(ans, a, m);</span><br><span class="line">        a = multi(a,a,m);</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Miller_Rabin</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">2</span>)<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>((n&lt;<span class="number">2</span>) || !(n&amp;<span class="number">1</span>))<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    ll m = n<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((m&amp;<span class="number">1</span>)==<span class="number">0</span>)&#123;</span><br><span class="line">        k++;</span><br><span class="line">        m&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Times; i++)&#123;</span><br><span class="line">        ll a = rand()%(n<span class="number">-1</span>)+<span class="number">1</span>;</span><br><span class="line">        ll x = quick_mod(a,m,n);</span><br><span class="line">        ll y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++)&#123;</span><br><span class="line">            y = multi(x,x,n);</span><br><span class="line">            <span class="keyword">if</span>(y==<span class="number">1</span> &amp;&amp; x!=<span class="number">1</span> &amp;&amp; x!= n<span class="number">-1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            x = y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(y!=<span class="number">1</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        ll n;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n);</span><br><span class="line">        <span class="keyword">if</span>(Miller_Rabin(n))<span class="built_in">puts</span>(<span class="string">"Yes"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>例题：[<strong><a href="http://www.51nod.com/onlineJudge/questionCode.html#!problemId=1186" target="_blank" rel="noopener">http://www.51nod.com/onlineJudge/questionCode.html#!problemId=1186</a></strong></p></blockquote><p>java写大数：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by huchi on 17-7-18.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> Times = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> BigInteger <span class="title">quick_mod</span><span class="params">(BigInteger a, BigInteger b, BigInteger m)</span></span>&#123;</span><br><span class="line">        BigInteger ans = BigInteger.ONE;</span><br><span class="line">        a = a.mod(m);</span><br><span class="line">        <span class="keyword">while</span>(!b.equals(BigInteger.ZERO))&#123;</span><br><span class="line">            <span class="keyword">if</span>(b.mod(BigInteger.valueOf(<span class="number">2</span>)).equals(BigInteger.ONE))&#123;</span><br><span class="line">                ans = (ans.multiply(a)).mod(m);</span><br><span class="line">                b = b.subtract(BigInteger.ONE);</span><br><span class="line">            &#125;</span><br><span class="line">            b = b.divide(BigInteger.valueOf(<span class="number">2</span>));</span><br><span class="line">            a = (a.multiply(a)).mod(m);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">Miller_Rabin</span><span class="params">(BigInteger n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n.equals(BigInteger.valueOf(<span class="number">2</span>)))<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(n.equals(BigInteger.ONE))<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span>((n.mod(BigInteger.valueOf(<span class="number">2</span>))).equals(BigInteger.ZERO))<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        BigInteger m = n.subtract(BigInteger.ONE);</span><br><span class="line">        BigInteger y = BigInteger.ZERO;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((m.mod(BigInteger.valueOf(<span class="number">2</span>))).equals(BigInteger.ZERO))&#123;</span><br><span class="line">            k++;</span><br><span class="line">            m = m.divide(BigInteger.valueOf(<span class="number">2</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        Random d = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//随机数</span></span><br><span class="line">            <span class="keyword">if</span>(n.compareTo(BigInteger.valueOf(<span class="number">10000</span>))==<span class="number">1</span>)&#123;</span><br><span class="line">                t = <span class="number">10000</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                t = n.intValue()-<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> a = d.nextInt(t) + <span class="number">1</span>;</span><br><span class="line">            BigInteger x = quick_mod(BigInteger.valueOf(a), m, n);</span><br><span class="line">            <span class="comment">//测试</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++)&#123;</span><br><span class="line">                y = (x.multiply(x)).mod(n);</span><br><span class="line">                <span class="keyword">if</span>(y.equals(BigInteger.ONE)</span><br><span class="line">                        &amp;&amp; !(x.equals(BigInteger.ONE))</span><br><span class="line">                        &amp;&amp; !(x.equals(n.subtract(BigInteger.ONE))))&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                x = y;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!(y.equals(BigInteger.ONE)))<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">while</span>(in.hasNextBigInteger())&#123;</span><br><span class="line">            BigInteger n = in.nextBigInteger();</span><br><span class="line">            <span class="keyword">if</span>(Miller_Rabin(n))System.out.println(<span class="string">"Yes"</span>);</span><br><span class="line">            <span class="keyword">else</span> System.out.println(<span class="string">"No"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="扩展欧几里得"><a href="#扩展欧几里得" class="headerlink" title="扩展欧几里得"></a>扩展欧几里得</h2><p>二元一次方程$$ax_1+by_1=gcd(a,b)$$;</p><p>a&gt;b时，b==0时，x=1,y=0,　否则设$bx_2+(a\ mod\ b)y_2 = gcd(b, a\ mod \ b)=gcd(a,b)$</p><p>又有$ax_1 +by_1=bx_2+(a-[\frac{a}{b}]b)y_2$</p><p>则有$x_1=y_2,y_1=x_2-[\frac{a}{b}]y_2$,　用递推实现．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">e_gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;d, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;</span><br><span class="line">        d=a,x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        e_gcd(b,a%b,d,y,x);</span><br><span class="line">        y -= (a/b)*x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代表的是ax+by=gcd(a,b)的解x,y,和d为gcd(a,b);，得到的x,y中a&gt;b则x为正．在gcd(a,b)==1的时候，可以领y=(y%a+a)％a把y变成正的，再根据等式把x变成负的就行．</p><p>例题：<a href="https://vjudge.net/problem/POJ-2142" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-2142</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b?gcd(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">e_gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;d, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;</span><br><span class="line">        d=a,x=<span class="number">1</span>,y=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        e_gcd(b,a%b,d,y,x);</span><br><span class="line">        y -= (a/b)*x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a,b,c;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;a,&amp;b,&amp;c) &amp;&amp; (a+b+c))&#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, d, tx, ty;</span><br><span class="line">        <span class="keyword">int</span> gd = gcd(a,b);</span><br><span class="line">        a /= gd; b/= gd; c/= gd;</span><br><span class="line">        e_gcd(a,b,d,x,y);</span><br><span class="line">        <span class="comment">//获取x非负的时候的情况</span></span><br><span class="line">        tx = x*c;</span><br><span class="line">        tx = (tx%b + b)%b;</span><br><span class="line">        ty = (c-tx*a)/b;</span><br><span class="line">        <span class="keyword">if</span>(ty &lt; <span class="number">0</span>)ty = -ty;</span><br><span class="line">        <span class="comment">//获取y非负的情况</span></span><br><span class="line">        y = y*c;</span><br><span class="line">        y = (y%a + a)%a;</span><br><span class="line">        x = (c-b*y)/a;</span><br><span class="line">        <span class="keyword">if</span>(x&lt;<span class="number">0</span>)x =-x;</span><br><span class="line">        <span class="keyword">if</span>(x+y&gt;tx+ty)&#123;</span><br><span class="line">            x=tx;</span><br><span class="line">            y=ty;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,x,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://vjudge.net/problem/HIT-2815" target="_blank" rel="noopener">https://vjudge.net/problem/HIT-2815</a></p><p>题目没读清，特判就写错了，扩展欧几里得和上面一道题一样的用．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b?gcd(b, a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">e_gcd</span><span class="params">(ll a, ll b, ll &amp;d, ll &amp;x, ll &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;</span><br><span class="line">        d = a; x = <span class="number">1</span>; y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        e_gcd(b,a%b,d,y,x);</span><br><span class="line">        y -= (a/b)*x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll t,a,b,d,x,y;<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a,&amp;b);</span><br><span class="line">        <span class="keyword">if</span>(a*b==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a==<span class="number">1</span> || b==<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(a==<span class="number">1</span> || b==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(max(a,b)==<span class="number">2</span>)</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"2"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(gcd(a,b)!=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            e_gcd(a,b,d,x,y);</span><br><span class="line">            ll tx,ty;</span><br><span class="line">            tx = (x%b+b)%b;</span><br><span class="line">            ty = (<span class="number">1</span>-a*x)/b;</span><br><span class="line">            <span class="keyword">if</span>(ty&lt;<span class="number">0</span>)ty = -ty;</span><br><span class="line">            y = (y%a+a)%a;</span><br><span class="line">            x = (<span class="number">1</span>-b*y)/a;</span><br><span class="line">            <span class="keyword">if</span>(x&lt;<span class="number">0</span>)x=-x;</span><br><span class="line">            <span class="keyword">if</span>(x+y&gt;tx+ty)&#123;</span><br><span class="line">                x = tx;</span><br><span class="line">                y = ty;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,x+y<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="毕达哥拉斯三元组的解"><a href="#毕达哥拉斯三元组的解" class="headerlink" title="毕达哥拉斯三元组的解"></a>毕达哥拉斯三元组的解</h2><p>$x^2+y^2=z^2$，只考虑本原解．不妨假设x为偶数,y,z为奇数.这样就必有$x=2mn,y=m^2-n^2,z=m^2+n^2$．</p><p>例题：<a href="https://vjudge.net/problem/POJ-1305" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-1305</a></p><p>输出两个数据，一个是z不大于n的本原解的个数，和本原解中没有用到的数的个数．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000111</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> biao[maxn];</span><br><span class="line"><span class="keyword">bool</span> flag[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b?gcd(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">memset</span>(flag,<span class="number">0</span>,<span class="keyword">sizeof</span> flag);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i*i &lt; maxn; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(gcd(i,j)!=<span class="number">1</span>)<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>((i&amp;<span class="number">1</span>)&amp;&amp;(j&amp;<span class="number">1</span>))<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(i*i+j*j&lt;maxn)biao[i*i+j*j]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">        biao[i]+=biao[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n))&#123;</span><br><span class="line">    <span class="built_in">memset</span>(flag,<span class="number">0</span>,<span class="keyword">sizeof</span> flag);</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i*i &lt; maxn; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(gcd(i,j)!=<span class="number">1</span>)<span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span>((i&amp;<span class="number">1</span>)&amp;&amp;(j&amp;<span class="number">1</span>))<span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k*(i*i+j*j)&lt;=n; k++)&#123;</span><br><span class="line">                    flag[<span class="number">2</span>*i*j*k]=flag[k*(i*i-j*j)]=flag[k*(i*i+j*j)]=<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span>(flag[i])ans++;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,biao[n],n-ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>例题二:</p><p>利用毕达哥拉斯三元组＋欧拉函数＋容斥原理</p><p><a href="https://vjudge.net/problem/HDU-3939??" target="_blank" rel="noopener">https://vjudge.net/problem/HDU-3939??</a>?</p><p>寻找满足的i,j满足gcd(i,j)=1,dfs()容斥原理来找有多少互斥的数．</p><p>这里需要判断i&lt;＝j和i&gt;j的情况．其中,i&lt;=j时，i为偶数,则直接加phi[i]，i为奇数时,由于j必须为偶数,不能用phi[i]，所以用容斥原理，一共i&gt;&gt;1个数(晒去了２的倍数)．大于时同理．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1001000</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> judge[maxn];</span><br><span class="line"><span class="keyword">int</span> prime[maxn/<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> phi[maxn];</span><br><span class="line"><span class="keyword">int</span> check[<span class="number">40</span>];</span><br><span class="line"><span class="keyword">int</span> tot,num;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    tot = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(judge, <span class="number">0</span>, <span class="keyword">sizeof</span> judge);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!judge[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i+i; j &lt; maxn; j+=i)&#123;</span><br><span class="line">                judge[j]=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            prime[tot++]=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++)phi[i]=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i+=<span class="number">2</span>)phi[i]&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; maxn; i+=<span class="number">2</span>)<span class="keyword">if</span>(phi[i]==i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; maxn; j+=i)&#123;</span><br><span class="line">            phi[j] = phi[j] - phi[j]/i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prime_check</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!judge[n])&#123;</span><br><span class="line">        check[num++]=n;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot &amp;&amp; n &gt; <span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%prime[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            check[num++]=prime[i];</span><br><span class="line">            <span class="keyword">while</span>(n%prime[i]==<span class="number">0</span>) n/=prime[i];</span><br><span class="line">            <span class="keyword">if</span>(n&gt;<span class="number">1</span> &amp;&amp; !judge[n])&#123;</span><br><span class="line">                check[num++]=n;</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//容斥原理计算无关的数fun(j)=j-(j/c1+j/c2+j/c3)+(j/(c1*c2)+j/(c1*c3)+j/(c2*c3))-(j/(c1*c2*c3))。</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> r, <span class="keyword">int</span> s, <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(k==num)&#123;</span><br><span class="line">        <span class="keyword">if</span>(r&amp;<span class="number">1</span>) ans -= n/s;</span><br><span class="line">        <span class="keyword">else</span> ans+= n/s;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(k+<span class="number">1</span>, r, s, n);</span><br><span class="line">    dfs(k+<span class="number">1</span>, r+<span class="number">1</span>, s*check[k], n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll L;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> t;<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;L);</span><br><span class="line">        <span class="keyword">int</span> m = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(<span class="number">1.0</span>*L);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = m; i &gt; <span class="number">0</span>; i--)&#123;</span><br><span class="line">            <span class="keyword">int</span> p = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(L - (ll)i*i);</span><br><span class="line">            <span class="comment">//需要寻找gcd(i,j)=1的个数</span></span><br><span class="line">            <span class="keyword">if</span>(i&lt;=p)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i&amp;<span class="number">1</span>)&#123;</span><br><span class="line">                    prime_check(i);</span><br><span class="line">                    dfs(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,i&gt;&gt;<span class="number">1</span>);</span><br><span class="line">                &#125;<span class="keyword">else</span> ans+=phi[i];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">// i&gt;p时，j所取的范围在[1,p]</span></span><br><span class="line">                prime_check(i);</span><br><span class="line">                <span class="keyword">if</span>(i&amp;<span class="number">1</span>)dfs(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,p&gt;&gt;<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">else</span> dfs(<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="欧拉函数与欧拉定理"><a href="#欧拉函数与欧拉定理" class="headerlink" title="欧拉函数与欧拉定理"></a>欧拉函数与欧拉定理</h2><p>定理一：$$m与n互素，\phi(mn)=\phi(m)\phi(n)$$, 所以n为奇数时，我们有$\phi(2n)=\phi(n)$</p><p>定理二: p是素数，有$\phi(p^a)=p^a-p^{a-1}$,容斥原理．</p><p>定理三: $n=p_1^{\alpha_1}p_2^{\alpha_2}…p_k^{\alpha_k}时，\phi(n)=n(1-\frac{1}{p_1})(1-\frac{1}{p_2})…(1-\frac{1}{p_k})$　定理１＋３</p><p>定理四: $\sum_{d|n}{\phi(d)}= n$ 莫比乌斯反演．</p><p>定理五: (a,m)=1,则$x \equiv ba^{\phi(m)-1} 是同于方程 ax \equiv b(mod \ m)$</p><p>定理六: n&gt;2时，$\phi(n)$为偶数</p><p><strong>定理三求解欧拉函数</strong>：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">phi</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i*i &lt;= n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">            ans = ans - ans/i;</span><br><span class="line">            <span class="keyword">while</span>(n%i==<span class="number">0</span>) n/=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n&gt;<span class="number">1</span>)ans = ans-ans/n;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>容斥原理，筛法去减不满足的．</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 100000</span></span><br><span class="line"><span class="keyword">int</span> p[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phi_table</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(p,<span class="number">0</span>,<span class="keyword">sizeof</span> p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++)p[i]=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i+=<span class="number">2</span>)p[i]&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; maxn; i+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(p[i]==i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; maxn; j+=i)</span><br><span class="line">                p[j]=p[j]-p[j]/i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="二次筛法"><a href="#二次筛法" class="headerlink" title="二次筛法"></a>二次筛法</h2><p>这道题有类似的在kuangbin的数论基础专题里有出现过．</p><p>例题：<a href="https://vjudge.net/problem/POJ-2689" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-2689</a></p><p>注意1　2这个样例．．．还有晒的时候不能把质数也晒了．．．．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 50000</span></span><br><span class="line"><span class="keyword">int</span> prime[maxn];</span><br><span class="line"><span class="keyword">bool</span> judge2[<span class="number">21</span>*maxn];</span><br><span class="line"><span class="keyword">bool</span> judge1[maxn];</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> tot=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(judge1,<span class="number">0</span>,<span class="keyword">sizeof</span> judge1);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i&lt;maxn; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!judge1[i])&#123;</span><br><span class="line">            prime[tot++] = i;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i+i; j &lt; maxn; j+=i)&#123;</span><br><span class="line">                judge1[j]=<span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> u,v;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v))&#123;</span><br><span class="line">        <span class="keyword">if</span>(u==<span class="number">1</span>)u=<span class="number">2</span>;</span><br><span class="line">        <span class="built_in">memset</span>(judge2,<span class="number">0</span>,<span class="keyword">sizeof</span> judge2);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(prime[i]&gt;v)<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">unsigned</span> <span class="keyword">int</span> j=u/prime[i]*prime[i];</span><br><span class="line">            <span class="keyword">if</span>(u%prime[i]==<span class="number">0</span> &amp;&amp; u!=prime[i])judge2[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(j&lt;=u)j+=prime[i];</span><br><span class="line">            <span class="keyword">if</span>(j==prime[i])j+=j;</span><br><span class="line">            <span class="keyword">for</span>(;j&lt;=v;j+=prime[i])&#123;</span><br><span class="line">                judge2[j-u]=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> st,stlen=maxn,ed,edlen=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cot=<span class="number">0</span>,len=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= v-u; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!judge2[i])&#123;</span><br><span class="line">                <span class="keyword">if</span>(len &amp;&amp;len&lt;stlen)&#123;</span><br><span class="line">                    st = i-len;</span><br><span class="line">                    stlen = len;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(len &amp;&amp; len&gt;edlen)&#123;</span><br><span class="line">                    ed = i-len;</span><br><span class="line">                    edlen = len;</span><br><span class="line">                &#125;</span><br><span class="line">                cot++;</span><br><span class="line">                len = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            len ++ ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(cot!=<span class="number">2</span> &amp;&amp; st==ed)&#123;</span><br><span class="line">            ed = st+stlen;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(cot&gt;<span class="number">1</span>)<span class="built_in">printf</span>(<span class="string">"%d,%d are closest, %d,%d are most distant.\n"</span>,u+st,u+st+stlen,u+ed,u+ed+edlen);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"There are no adjacent primes."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="逆元"><a href="#逆元" class="headerlink" title="逆元"></a>逆元</h2><p>正整数a,m，如果有$ax \equiv 1(mod \ m)$,这个同于方程中x的最小正整数解叫做a模m的逆元．</p><p>逆元一般用扩展欧几里得算法来求．m为素数时，由费马小定理得到逆元为$a^{m-2}modm$</p><p><strong><em>逆元常见问题</em></strong></p><p>已知b|a，求解$ans = \frac{a}{b}mod \ m$</p><p>常见解法:扩展欧几里得．m是素数时，直接用费马小定理．但他们都需要a与m互素．</p><p>除法取模求逆元的通用方法： $ans =\frac{ a \ mod(mb)}{b}$<br>$$<br>\frac{a}{b}=km+x(x&lt;m),a=kbm+bx,a\ mod(bm)=bx,x = \frac{a\ mod(bm)}{b}<br>$$<br>例题：<a href="https://vjudge.net/problem/POJ-1845" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-1845</a></p><p>求$A^B$的所有因子和对9901取余的结果．</p><p>考虑$$A=p_1^{\alpha_1}p_2^{\alpha_2}…p_k^{\alpha_k} ,A^B=p_1^{\alpha_1 B}p_2^{\alpha_2B}…p_k^{\alpha_kB}$$</p><p>所有的因子和：$$sum=\prod_{1\le i \le k} \sum_{0 \le j \le \alpha_iB} p_i^{j}$$</p><p>可以用二分求等比数列和，也可以用等比数列公式(需要用逆元)直接求.分别写在了Method_one和Method_two中．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 10000</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line">ll mod =<span class="number">9901</span>;</span><br><span class="line"><span class="keyword">bool</span> judge[maxn];</span><br><span class="line">ll check[maxn][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> prime[maxn/<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> tot,num;</span><br><span class="line">ll a,b;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    tot=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(judge, <span class="number">0</span>, <span class="keyword">sizeof</span> judge);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!judge[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i+i; j &lt; maxn; j+=i)&#123;</span><br><span class="line">                judge[j]=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            prime[tot++]=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">multi</span><span class="params">(ll a, ll b, ll m)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    a %= m;</span><br><span class="line">    <span class="keyword">while</span>(b)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>)ans = (ans+a)%m;</span><br><span class="line">        a = (a+a)%m;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">largequickmod</span><span class="params">(ll p, ll k, ll m)</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>)ans = multi(ans,p,m);</span><br><span class="line">        p = multi(p,p,m);</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quickmod</span><span class="params">(ll p, ll k)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    p%=mod;</span><br><span class="line">    <span class="keyword">while</span>(k)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k&amp;<span class="number">1</span>)ans = ans*p%mod;</span><br><span class="line">        p = (p*p)%mod;</span><br><span class="line">        k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(ll p, ll k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(k==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    ll temp = quickmod(p,(k&gt;&gt;<span class="number">1</span>))%mod;</span><br><span class="line">    <span class="keyword">if</span>(k&amp;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> S(p,k&gt;&gt;<span class="number">1</span>)%mod*(<span class="number">1</span>+temp*p%mod)%mod;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (S(p,(k&gt;&gt;<span class="number">1</span>)<span class="number">-1</span>)%mod*(<span class="number">1</span>+temp*p%mod)%mod+temp)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Method_one</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; i++)&#123;</span><br><span class="line">        ans = (ans * S(check[i][<span class="number">0</span>], b*check[i][<span class="number">1</span>]))%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(a==<span class="number">0</span>)ans=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Method_two</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; i++)&#123;</span><br><span class="line">        ll M = mod*(check[i][<span class="number">0</span>]<span class="number">-1</span>);</span><br><span class="line">        ans *= (largequickmod(check[i][<span class="number">0</span>], check[i][<span class="number">1</span>]*b+<span class="number">1</span>, M)+M<span class="number">-1</span>)/(check[i][<span class="number">0</span>]<span class="number">-1</span>);</span><br><span class="line">        ans %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;a,&amp;b))&#123;</span><br><span class="line">        ll temp = a;</span><br><span class="line">        num=<span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(check, <span class="number">0</span>, <span class="keyword">sizeof</span> check);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(temp&lt;=<span class="number">1</span>)<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(temp%prime[i]==<span class="number">0</span>)&#123;check[num++][<span class="number">0</span>]=prime[i];&#125;</span><br><span class="line">            <span class="keyword">while</span>(temp%prime[i]==<span class="number">0</span>)&#123;</span><br><span class="line">                temp/=prime[i];</span><br><span class="line">                check[num<span class="number">-1</span>][<span class="number">1</span>]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(temp&gt;<span class="number">1</span>)&#123;</span><br><span class="line">            check[num][<span class="number">0</span>]=temp;</span><br><span class="line">            check[num++][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//Method_one();</span></span><br><span class="line">        Method_two();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>1→p模p的所有逆元，这里p为奇质数．用快速幂的复杂度Ｏ(plog(p)),用递推式可以优化到Ｏ(p)：<br>$$<br>inv[i] = (M-M/i)<em>inv[M\%i] \%M \ 推导：t=M/i,k=M\%i,有t</em>i+k \equiv 0 (modM), -t<em>i \equiv k(modM)\ 两边同时除i</em>k记作:-t<em>inv[k] \equiv inv<a href="modM">i</a>\ 即　inv[i] = (M- M/i)</em>inv[M\%i]\%M<br>$$<br>初始化inv[1]=1,就可以通过递推法求出1→p模奇素数的所有逆元．</p><p><a href="http://www.lydsy.com/JudgeOnline/problem.php?id=2186" target="_blank" rel="noopener">http://www.lydsy.com/JudgeOnline/problem.php?id=2186</a></p><p>例题：1-N!中与M!互质的数的个数，M&lt;=N;M!|N!, ．当n是m的倍数时，1-n中与m互素的个数为$\frac{n}{m}\phi(m)$</p><p>题目中　$\frac{N!}{M!}\phi(M!) = \frac{N!}{M!}M!(1-\frac{1}{p_1})(1-\frac{1}{p_2})…(1-\frac{1}{p_k})$.　　</p><p>时间卡的特别紧．bool开的就超时了．inv[i]算逆元．multi[maxn]算阶乘取模，要求p与m互质，否则需要用除法取模．</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 10000005</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line">ll mod;</span><br><span class="line"><span class="built_in">bitset</span>&lt;maxn&gt; judge;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    judge.<span class="built_in">set</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">4</span>; i &lt; maxn; i+=<span class="number">2</span>)judge[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; maxn; i+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(judge[i])&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i+i; j &lt; maxn; j+=i)&#123;</span><br><span class="line">                judge[j]=<span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ll multi[maxn];</span><br><span class="line"><span class="keyword">int</span> inv[maxn];</span><br><span class="line">ll ans[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> T,R;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;T,&amp;R);</span><br><span class="line">    mod = R;</span><br><span class="line">    multi[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">        multi[i]=multi[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; mod &amp;&amp; i &lt; maxn; i++)&#123;</span><br><span class="line">        inv[i]=(mod-mod/i)*inv[mod%i]%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    ans[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(judge[i])&#123;</span><br><span class="line">            ans[i] = ans[i<span class="number">-1</span>]*(i<span class="number">-1</span>)%mod;</span><br><span class="line">            ans[i] = ans[i]*inv[i%mod]%mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ans[i] = ans[i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> n,m;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">        ll anss = <span class="number">1L</span>L*multi[n]*ans[m]%mod;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,anss);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="欧拉筛"><a href="#欧拉筛" class="headerlink" title="欧拉筛"></a>欧拉筛</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getphi</span><span class="params">()</span>    </span></span><br><span class="line"><span class="function"></span>&#123;    </span><br><span class="line">   <span class="keyword">int</span> i,j;    </span><br><span class="line">   phi[<span class="number">1</span>]=<span class="number">1</span>;    </span><br><span class="line">   <span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=N;i++)<span class="comment">//相当于分解质因式的逆过程    </span></span><br><span class="line">   &#123;    </span><br><span class="line">       <span class="keyword">if</span>(!mark[i])    </span><br><span class="line">           &#123;    </span><br><span class="line">             prime[++tot]=i;<span class="comment">//筛素数的时候首先会判断i是否是素数。    </span></span><br><span class="line">             phi[i]=i<span class="number">-1</span>;<span class="comment">//当 i 是素数时 phi[i]=i-1    </span></span><br><span class="line">             &#125;    </span><br><span class="line">       <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=tot;j++)    </span><br><span class="line">       &#123;    </span><br><span class="line">          <span class="keyword">if</span>(i*prime[j]&gt;N)  <span class="keyword">break</span>;    </span><br><span class="line">          mark[i*prime[j]]=<span class="number">1</span>;<span class="comment">//确定i*prime[j]不是素数    </span></span><br><span class="line">          <span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>)<span class="comment">//接着我们会看prime[j]是否是i的约数    </span></span><br><span class="line">          &#123;    </span><br><span class="line">             phi[i*prime[j]]=phi[i]*prime[j];<span class="keyword">break</span>;    </span><br><span class="line">          &#125;    </span><br><span class="line">          <span class="keyword">else</span>  phi[i*prime[j]]=phi[i]*(prime[j]<span class="number">-1</span>);<span class="comment">//其实这里prime[j]-1就是phi[prime[j]]，利用了欧拉函数的积性    </span></span><br><span class="line">       &#125;    </span><br><span class="line">   &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><div class="copyright"><p><span>本文标题:</span><a href="/2017/07/19/acm/Acdreamer博客数论学习(1)/">Acdreamer博客数论学习(1)</a></p><p><span>文章作者:</span><a href="/" title="回到主页">呼哧</a></p><p><span>发布时间:</span>2017-07-19, 18:40:42</p><p><span>最后更新:</span>2018-08-04, 02:45:59</p><p><span>原始链接:</span><a class="post-url" href="/2017/07/19/acm/Acdreamer博客数论学习(1)/" title="Acdreamer博客数论学习(1)">http://hu-chi.github.io/2017/07/19/acm/Acdreamer博客数论学习(1)/</a> <span class="copy-path" data-clipboard-text="原文: http://hu-chi.github.io/2017/07/19/acm/Acdreamer博客数论学习(1)/　　作者: 呼哧" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span><script>var clipboard=new Clipboard(".copy-path")</script></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target="_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。</p></div><nav id="article-nav"><div id="article-nav-newer" class="article-nav-title"><a href="/2017/07/19/acm/高斯消元/">高斯消元</a></div><div id="article-nav-older" class="article-nav-title"><a href="/2017/07/16/acm/数论基础专题整理(1)/">数论专题整理(1)</a></div></nav></article><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Acdreamer博客数论学习"><span class="toc-number">1.</span> <span class="toc-text">Acdreamer博客数论学习</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Day-One"><span class="toc-number">2.</span> <span class="toc-text">Day One</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#等比数列求和．"><span class="toc-number">2.1.</span> <span class="toc-text">等比数列求和．</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#素数定理"><span class="toc-number">2.2.</span> <span class="toc-text">素数定理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定理-gcd-a-n-1-a-m-1-a-gcd-n-m-1"><span class="toc-number">2.3.</span> <span class="toc-text">定理$gcd(a^n-1,a^m-1)=a^{gcd(n,m)}-1$</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定理扩展-a-gt-b-gcd-a-b-1-gcd-a-m-b-m-a-n-b-n-a-gcd-m-n-b-gcd-m-n"><span class="toc-number">2.4.</span> <span class="toc-text">定理扩展$a&gt;b,gcd(a,b)=1, gcd(a^m-b^m,a^n-b^n)=a^{gcd(m,n)}-b^{gcd(m,n)}$</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定理-G-gcd-C-n-1-C-n-2-C-n-3-…-Cn-n-1"><span class="toc-number">2.5.</span> <span class="toc-text">定理$G=gcd(C_n^1,C_n^2,C_n^3,…,Cn^{n-1})$</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定理-F-n-为斐波那契额数列-，gcd-F-m-F-n-F-gcd-m-n"><span class="toc-number">2.6.</span> <span class="toc-text">定理$F_n 为斐波那契额数列 ，gcd(F_m,F_n)=F_{gcd(m,n)}$</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定理：给定两个互素的正整数A和B，那么他们最大不能组合的数为AB-A-B-不能组合的个数为num-frac-A-1-B-1-2"><span class="toc-number">2.7.</span> <span class="toc-text">定理：给定两个互素的正整数Ａ和Ｂ，那么他们最大不能组合的数为AB-A-B,不能组合的个数为num=$\frac{(A-1)(B-1)}{2}$</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#定理-sum-gcd-i-N-sum-d-phi-frac-N-d"><span class="toc-number">2.8.</span> <span class="toc-text">定理$\sum{gcd(i,N)=\sum{d\phi(\frac{N}{d})}}$</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#剩下没有题目的定理"><span class="toc-number">2.9.</span> <span class="toc-text">剩下没有题目的定理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Day-Two"><span class="toc-number">3.</span> <span class="toc-text">Day Two</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#卢卡斯－莱默检验法-检验梅森素数"><span class="toc-number">3.1.</span> <span class="toc-text">卢卡斯－莱默检验法 检验梅森素数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Miller-Rabin素数测试"><span class="toc-number">3.2.</span> <span class="toc-text">Miller-Rabin素数测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#扩展欧几里得"><span class="toc-number">3.3.</span> <span class="toc-text">扩展欧几里得</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#毕达哥拉斯三元组的解"><span class="toc-number">3.4.</span> <span class="toc-text">毕达哥拉斯三元组的解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#欧拉函数与欧拉定理"><span class="toc-number">3.5.</span> <span class="toc-text">欧拉函数与欧拉定理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二次筛法"><span class="toc-number">3.6.</span> <span class="toc-text">二次筛法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#逆元"><span class="toc-number">3.7.</span> <span class="toc-text">逆元</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#欧拉筛"><span class="toc-number">3.8.</span> <span class="toc-text">欧拉筛</span></a></li></ol></li></ol></div><style>.left-col .switch-area,.left-col .switch-btn{display:none}.toc-level-3 i,.toc-level-3 ol{display:none!important}</style><input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录"><script>yiliaConfig.toc=["隐藏目录","显示目录",!0]</script><div class="share"><div class="bdsharebuttonbox"><a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a> <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a> <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a> <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a> <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a> <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a> <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></a></div><script>with(window._bd_share_config={common:{bdSnsKey:{},bdText:"Acdreamer博客数论学习(1)　| Play with huchi　",bdMini:"2",bdMiniList:!1,bdPic:"",bdStyle:"0",bdSize:"24"},share:{}},document)(getElementsByTagName("head")[0]||body).appendChild(createElement("script")).src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion="+~(-new Date/36e5)</script></div><div class="scroll" id="post-nav-button"><a href="/2017/07/19/acm/高斯消元/" title="上一篇: 高斯消元"><i class="fa fa-angle-left"></i> </a><a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a> <a href="/2017/07/16/acm/数论基础专题整理(1)/" title="下一篇: 数论专题整理(1)"><i class="fa fa-angle-right"></i></a></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/acm/数论/">数论退役帖</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/20/acm/网络流/">网络流经典题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/04/acm/hash/">hash在ACM种的应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/03/hadoop/wordcount/">Hadoop的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/03/hadoop/Linux安装hadoop/">Hadoop的安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/19/machineLearning/Lesson1/">机器学习初识</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/29/随笔集/2017年末总结/">2017年末总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/21/设计模式/python设计模式(4)/">python设计模式(四)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/20/设计模式/python设计模式(3)/">python设计模式(三)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/19/设计模式/python设计模式(2)/">python设计模式(二)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/24/设计模式/python设计模式(1)/">python设计模式(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/12/fluentPython/fluent_python5/">fluent python (五)一等函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/12/fluentPython/fluent_python2/">fluent python (二)python数据模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/08/fluentPython/fluent_python1/">fluent python (一)python数据模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/08/acm/循环节/">指数循环节</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/08/acm/01分数规划/">01分数规划</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/acm/大数模板/">大数模版</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/acm/堆排序/">堆排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/17/acm/容斥原理/">容斥原理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/10/acm/三分与退火模拟/">三分与模拟退火</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/05/acm/Acdreamer博客数论学习(2)/">Acdreamer博客数论学习(2)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/04/acm/从dp的全世界路过(1)/">从dp的全世界路过(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/20/acm/低等数论1/">数论知识点摘要1</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/19/acm/高斯消元/">高斯消元</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/19/acm/Acdreamer博客数论学习(1)/">Acdreamer博客数论学习(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/16/acm/数论基础专题整理(1)/">数论专题整理(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/12/acm/数位dp/">数位dp专题整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/09/读书笔记/拆掉思维里的墙(下)/">拆掉思维里的墙(下)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/07/acm/7-7acm整理笔记/">acm7-7总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/30/读书笔记/拆掉思维里的墙(上)/">拆掉思维里的墙(上)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/28/脚本/Script_ascii/">script： translate picture into ascii.text</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/27/读书笔记/哈佛的6堂独立思考课/">哈佛的6堂独立思考课</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/24/网页学习/djangoStart01/">Django_GO01</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/14/Linux-计算机基础认识/">Linux_计算机基础认识</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/10/python网络编程-init/">python网络编程.init()</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/07/随笔集/新的开始/">新的开始</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/07/网页学习/测试jsDOM笔记/">测试jsDOM入门笔记</a></li></ul><script></script></div><footer id="footer"><div class="outer"><div id="footer-info"><div class="footer-left"><i class="fa fa-copyright"></i> 2018 呼哧</div><div class="footer-right"><a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a> Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i></div></div><div class="visit"><span id="busuanzi_container_site_pv" style="display:none"><span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span> </span></span><span>| </span><span id="busuanzi_container_page_pv" style="display:none"><span id="page-visit" title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span></span></span></div></div></footer></div><script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script><script>$(document).ready(function(){if(-1<window.navigator.userAgent.indexOf("iPad")||"none"===$(".left-col").css("display")){var a=["#9db3f4","#414141","#e5a859","#f5dfc6","#c084a0","#847e72","#cd8390","#996731"],c=Math.ceil(Math.random()*(a.length-1));$("body").css({"background-color":a[c],"background-size":"cover"})}else{var e="url(/background/bg-x.jpg)".replace(/x/gi,Math.ceil(5*Math.random()));$("body").css({background:e,"background-attachment":"fixed","background-size":"cover"})}})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});</script><script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><div class="scroll" id="scroll"><a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a> <a href="#comments" onclick="load$hide()" title="查看评论"><i class="fa fa-comments-o"></i></a> <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a></div><script>var oOpenInNew={archives:".archive-article-title",miniArchives:"a.post-list-link",friends:"#js-friends a",socail:".social a"};for(var x in oOpenInNew)$(oOpenInNew[x]).attr("target","_blank")</script><script>var titleTime,originTitle=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="(つェ⊂) 我藏好了哦~ "+originTitle,clearTimeout(titleTime)):(document.title="(*´∇｀*) 被你发现啦~ "+originTitle,titleTime=setTimeout(function(){document.title=originTitle},2e3))})</script><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body>